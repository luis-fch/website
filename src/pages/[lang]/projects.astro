---
import { getCollection } from "astro:content";
import {
  getLangFromUrl,
  useTranslations,
  getLanguageStaticPaths,
} from "../../i18n/utils";
import HomeLayout from "../../layouts/HomeLayout.astro";
import BlogCard from "../../components/BlogCard.astro";

const urlLang = getLangFromUrl(Astro.url);
const t = useTranslations(urlLang);

export async function getStaticPaths() {
  return getLanguageStaticPaths();
}

const allProjects = await getCollection("projects");
const projects = allProjects.filter((project) => project.id.startsWith(`${urlLang}`));

// For now I'll show all projects in the same page
const sortedProjects = projects.sort(
  (a, b) =>
    new Date(b.data.published_date).getTime() -
    new Date(a.data.published_date).getTime(),
);
---

<HomeLayout title={t("projects.head.title")}>
  <main class="px-4 py-12 my-8">
    <h1 class="text-3xl font-bold mb-8">{t("projects.h1.recent")}</h1>
    <div class="grid gap-2">
      {
        sortedProjects.map((project) => (
        // TODO: Add project card component
        <p>{project.data.title}</p>
        ))
      }
    </div>
  </main>
</HomeLayout>

